train:
  inference:
    method: 'snpe'

  density_estimator:
    embedding_net: 
      type: lstm_small
      hidden_size: 64
      output_size: 32
    posterior_nn:
      model: maf
      hidden_features: 64
      num_transforms: 2
    

  training:
    
    learning_rate         : 1e-3
    improvement_threshold : 0.0005 # improvement bigger than this threshold is considered as an improvement
    stop_after_epochs     : 12
    stop_after_dsets      : 5
    clip_max_norm         : 4.0

    min_num_epochs        : 30
    max_num_epochs        : 2147483647
    min_num_dsets         : 10
    max_num_dsets         : 2147483647

    scheduler             : 'ReduceLROnPlateau'
    scheduler_params      : {'patience': 3, 'factor': 0.5, 'min_lr': 0}
    # scheduler             : 'CosineAnnealingWarmRestarts'
    # scheduler_params      : {'T_0': 7, 'T_mult': 2}
    
    print_freq            : 2 # 20 records per epoch
    num_atoms             : 10
    num_rounds            : 3
    num_runs              : 10
    
  posterior:
    sampling_num  : 2000
    val_set_size  : 1
    # step          : 2     # the epoch steps to check posterior during training